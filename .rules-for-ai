# AIへの指示 (.rules-for-ai)

## 基本方針
- Always respond in 日本語
- 優先順位: わかりやすさを最優先
- 要求したリファクタリング以外の変更は許可を得ること
- 曖昧な要求はすぐに反映せず、ヒアリングを行う

## コード品質
- 複雑なコードには必ずコメントを付ける
- 定義した関数・クラスには説明のコメントを必ず追加すること
- UNIX哲学に基づき、関数が長すぎる場合は適切に分割すること
- ファイルの最終行に必ず空行を入れること
- TypeScriptの型安全性を維持（`any`の使用を避ける）
- エラーハンドリングを必ず実装し、適切なログ出力を行う

## Git管理
- テストが全て通ったことを確認してからdevブランチにコミット
- 新規生成ファイル（ビルド成果物、テスト結果など）が発生した場合、`.gitignore`への追記の必要性を確認
- Conventional Commitsフォーマットを使用（`feat:`, `fix:`, `refactor:`, `test:`, `docs:`, `chore:`）
- コミット前に`git diff --cached`で変更内容を確認し、機密情報が含まれていないか確認
- ファイルの最終行にさらに空行を入れ、最終行が空行になるようにする

## テスト・TDD
- コード変更後は必ず`npm run build`と`npm test`を実行して成功を確認
- 新機能追加時はTDDの手順を厳守:
  1. **レッド**: まず失敗するテストを書く
  2. **グリーン**: テストを通す最小限の実装を行う
  3. **リファクタ**: テストが通る状態を保ちながらコードを改善
- 既存コードの改善時も、可能な限りテストファーストで進める

## プロジェクト固有ルール
- ファイルアップロード機能では適切なバリデーションを実施
- サーバー側とクライアント側の両方でエラーハンドリング
- 主要な変更は`SPEC.md`やREADMEに反映する
